#!/usr/bin/python
# -*- coding: utf-8 -*-

#Imports
import numpy as np

#Function
def geojson_bbox(geojson, extend=True):
    if geojson['type'] == 'FeatureCollection':
    	bbox = []
        for f in geojson['features']:
            if f['geometry']['type'] == 'MultiPolygon':
    	        a = np.array(f['geometry']['coordinates'])
    	        for _ in range(2):
    	            a = np.concatenate(a)
    	    elif f['geometry']['type'] == 'MultiLineString':
    	    	a = np.array(f['geometry']['coordinates'])
    	    	a = np.concatenate(a)
    	    elif f['geometry']['type'] == 'Point':
    	    	a = np.array([f['geometry']['coordinates']])
    	    else:
                a = np.array(f['geometry']['coordinates']).squeeze()
            a = np.array([a[:,0].min(), a[:,1].min(), a[:,0].max(), a[:,1].max()]).tolist()
            bbox.append(a)
        if extend:
            print 'Extended bbox for all features in collection:'
            rows = len(bbox)*2
            a = np.array(bbox).reshape(rows,2)
            bbox = np.array([a[:,0].min(), a[:,1].min(), a[:,0].max(), a[:,1].max()]).tolist()
        else:
            print 'Bbox for every feature in collection:'
    else:
    	print 'Bbox for feature:'
        try:
    	    geo_type = geojson['geometry']['type']
    	    coords = geojson['geometry']['coordinates']
    	except:
    	    geo_type = geojson['type']
    	    coords = geojson['coordinates']
    	if geo_type == 'MultiPolygon':
    	    a = np.array(coords)
    	    for _ in range(2):
    	        a = np.concatenate(a)
    	elif geo_type == 'MultiLineString':
    	    	a = np.array(coords)
    	    	a = np.concatenate(a)
    	elif geo_type == 'Point':
    	    a = np.array([coords])
    	else:	
    	    a = np.array(coords).squeeze()
    	bbox = np.array([a[:,0].min(), a[:,1].min(), a[:,0].max(), a[:,1].max()]).tolist()
    return bbox

#Sample data sets
feature = {"type": "Feature","geometry": {"type": "Polygon","coordinates": [
                [[-80.72487831115721,35.26545403190955],[-80.72135925292969,35.26727607954368],
                [-80.71517944335938,35.26769654625573],[-80.7125186920166,35.27035945142482],
                [-80.70857048034668,35.268257165144064],[-80.70479393005371,35.268397319259996],
                [-80.70324897766113,35.26503355355979],[-80.71088790893555,35.2553619492954],
                [-80.71681022644043,35.2553619492954],[-80.7150936126709,35.26054831539319],
                [-80.71869850158691,35.26026797976481],[-80.72032928466797,35.26061839914875],
                [-80.72264671325684,35.26033806376283],[-80.72487831115721,35.26545403190955]]]},
                "properties": {"name": "Plaza Road Park"}}
feature_collection = {"type": "FeatureCollection","features": [
                     {"type": "Feature","properties": {},"geometry": {"type": "Polygon","coordinates": [
                     [[16.81629180908203,52.06568369340972],[16.821613311767575,52.063520272874996],
                      [16.821613311767575,52.06225383173856],[16.82530403137207,52.061092895817055],
                      [16.824960708618164,52.0603541027014],[16.83629035949707,52.055657203557935],
                      [16.83208465576172,52.053493297345774],[16.826763153076172,52.056184969661984],
                      [16.822729110717773,52.05829597173031],[16.818866729736328,52.05803210192718],
                      [16.8131160736084,52.06014301670964],[16.814746856689453,52.06151505782529],
                      [16.81629180908203,52.06568369340972]]]}},
                     {"type": "Feature","properties": {},"geometry": {"type": "Point","coordinates": [
                       16.64154052734375,52.08372570381537]}},
                     {"type": "Feature","properties": {},"geometry": {"type": "Point","coordinates": [
                       16.93817138671875,52.414147367821286]}},
                     {"type": "Feature","properties": {},"geometry": {"type": "LineString","coordinates": [
                      [16.644973754882812,52.08667925646318],[16.627120971679688,52.12379295938503],
                      [16.651840209960938,52.142338229345874],[16.710548400878906,52.17582658728107],
                      [16.743507385253906,52.25807132666112],[16.850624084472656,52.244829908062734],
                      [16.86023712158203,52.28958260712568],[16.879119873046875,52.34582700615622],
                      [16.929244995117188,52.40702686846808],[16.933021545410156,52.41058726183423]]}}
                     ]}
geojson = {"type": "MultiPolygon","coordinates": [
            [[[-84.32281494140625,34.9895035675793],[-84.29122924804688,35.21981940793435],
              [-84.24041748046875,35.25459097465022],[-84.22531127929688,35.266925688950074],
              [-84.20745849609375,35.26580442886754],[-84.19921875,35.24674063355999],
              [-84.16213989257812,35.24113278166642],[-84.12368774414062,35.24898366572645],
              [-84.09072875976562,35.24898366572645],[-84.08798217773438,35.264683153268116],
              [-84.04266357421875,35.27701633139884],[-84.03030395507812,35.291589484566124],
              [-84.0234375,35.306160014550784],[-84.03305053710936,35.32745068492882],
              [-84.03579711914062,35.34313496028189],[-84.03579711914062,35.348735749472546],
              [-84.01657104492188,35.35545618392078],[-84.01107788085938,35.37337460834958],
              [-84.00970458984374,35.39128905521763],[-84.01931762695312,35.41479572901859],
              [-84.00283813476562,35.429344044107154],[-83.93692016601562,35.47409160773029],
              [-83.91220092773438,35.47632833265728],[-83.88885498046875,35.504282143299655],
              [-83.88473510742186,35.516578738902936],[-83.8751220703125,35.52104976129943],
              [-83.85314941406249,35.52104976129943],[-83.82843017578125,35.52104976129943],
              [-83.8092041015625,35.53446133418443],[-83.80233764648438,35.54116627999813],
              [-83.76800537109374,35.56239491058853],[-83.7432861328125,35.56239491058853],
              [-83.71994018554688,35.56239491058853],[-83.67050170898438,35.569097520776054],
              [-83.6334228515625,35.570214567965984],[-83.61007690429688,35.576916524038616],
              [-83.59634399414061,35.574682600980914],[-83.5894775390625,35.55904339525896],
              [-83.55239868164062,35.56574628576276],[-83.49746704101562,35.563512051219696],
              [-83.47000122070312,35.586968406786475],[-83.4466552734375,35.60818490437746],
              [-83.37936401367188,35.63609277863135],[-83.35739135742188,35.65618041632016],
              [-83.32305908203124,35.66622234103479],[-83.3148193359375,35.65394870599763],
              [-83.29971313476561,35.660643649881614],[-83.28598022460938,35.6718006423877],
              [-83.26126098632811,35.6907639509368],[-83.25714111328125,35.69968630125201],
              [-83.25576782226562,35.715298012125295],[-83.23516845703125,35.72310272092263],
              [-83.19808959960936,35.72756221127198],[-83.16238403320312,35.753199435570316],
              [-83.15826416015625,35.76322914549896],[-83.10333251953125,35.76991491635478],
              [-83.08685302734375,35.7843988251953],[-83.0511474609375,35.787740890986576],
              [-83.01681518554688,35.78328477203738],[-83.001708984375,35.77882840327371],
              [-82.96737670898438,35.793310688351724],[-82.94540405273438,35.820040281161],
              [-82.9193115234375,35.85121343450061],[-82.9083251953125,35.86902116501695],
              [-82.90557861328125,35.87792352995116],[-82.91244506835938,35.92353244718235],
              [-82.88360595703125,35.94688293218141],[-82.85614013671875,35.951329861522666],
              [-82.8424072265625,35.94243575255426],[-82.825927734375,35.92464453144099],
              [-82.80670166015625,35.927980690382704],[-82.80532836914062,35.94243575255426],
              [-82.77923583984375,35.97356075349624],[-82.78060913085938,35.99245209055831],
              [-82.76138305664062,36.00356252895066],[-82.69546508789062,36.04465753921525],
              [-82.64465332031249,36.060201412392914],[-82.61306762695312,36.060201412392914],
              [-82.60620117187499,36.033552893400376],[-82.60620117187499,35.991340960635405],
              [-82.60620117187499,35.97911749857497],[-82.5787353515625,35.96133453736691],
              [-82.5677490234375,35.951329861522666],[-82.53067016601562,35.97244935753683],
              [-82.46475219726562,36.006895355244666],[-82.41668701171875,36.070192281208456],
              [-82.37960815429686,36.10126686921446],[-82.35488891601562,36.117908916563685],
              [-82.34115600585936,36.113471382052175],[-82.29583740234375,36.13343831245866],
              [-82.26287841796874,36.13565654678543],[-82.23403930664062,36.13565654678543],
              [-82.2216796875,36.154509006695],[-82.20382690429688,36.15561783381855],
              [-82.19009399414062,36.144528857027744],[-82.15438842773438,36.15007354140755],
              [-82.14065551757812,36.134547437460064],[-82.1337890625,36.116799556445024],
              [-82.12142944335938,36.10570509327921],[-82.08984375,36.10792411128649],
              [-82.05276489257811,36.12678323326429],[-82.03628540039062,36.12900165569652],
              [-81.91268920898438,36.29409768373033],[-81.89071655273438,36.30959215409138],
              [-81.86325073242188,36.33504067209607],[-81.83029174804688,36.34499652561904],
              [-81.80145263671875,36.35605709240176],[-81.77947998046874,36.34610265300638],
              [-81.76162719726562,36.33835943134047],[-81.73690795898438,36.33835943134047],
              [-81.71905517578125,36.33835943134047],[-81.70669555664062,36.33504067209607],
              [-81.70669555664062,36.342784223707234],[-81.72317504882812,36.357163062654365],
              [-81.73278808593749,36.379279167407965],[-81.73690795898438,36.40028364332352],
              [-81.73690795898438,36.41354670392876],[-81.72454833984374,36.423492513472326],
              [-81.71768188476562,36.445589751779174],[-81.69845581054688,36.47541104282962],
              [-81.69845581054688,36.51073994146672],[-81.705322265625,36.53060536411363],
              [-81.69158935546875,36.55929085774001],[-81.68060302734375,36.56480607840351],
              [-81.68197631835938,36.58686302344181],[-81.04202270507812,36.56370306576917],
              [-80.74264526367186,36.561496993252575],[-79.89120483398438,36.54053616262899],
              [-78.68408203124999,36.53943280355122],[-77.88345336914062,36.54053616262899],
              [-76.91665649414062,36.54163950596125],[-76.91665649414062,36.55046568575947],
              [-76.31103515625,36.551568887374],[-75.79605102539062,36.54936246839778],
              [-75.6298828125,36.07574221562703],[-75.4925537109375,35.82226734114509],
              [-75.3936767578125,35.639441068973916],[-75.41015624999999,35.43829554739668],
              [-75.43212890625,35.263561862152095],[-75.487060546875,35.18727767598896],
              [-75.5914306640625,35.17380831799959],[-75.9210205078125,35.04798673426734],
              [-76.17919921875,34.867904962568744],[-76.41540527343749,34.62868797377061],
              [-76.4593505859375,34.57442951865274],[-76.53076171875,34.53371242139567],
              [-76.5911865234375,34.551811369170494],[-76.651611328125,34.615126683462194],
              [-76.761474609375,34.63320791137959],[-77.069091796875,34.59704151614417],
              [-77.376708984375,34.45674800347809],[-77.5909423828125,34.3207552752374],
              [-77.8326416015625,33.97980872872457],[-77.9150390625,33.80197351806589],
              [-77.9754638671875,33.73804486328907],[-78.11279296875,33.8521697014074],
              [-78.2830810546875,33.8521697014074],[-78.4808349609375,33.815666308702774],
              [-79.6728515625,34.8047829195724],[-80.782470703125, 34.836349990763864],
              [-80.782470703125,34.91746688928252],[-80.9307861328125,35.092945313732635],
              [-81.0516357421875,35.02999636902566],[-81.0516357421875,35.05248370662468],
              [-81.0516357421875,35.137879119634185],[-82.3150634765625,35.19625600786368],
              [-82.3590087890625,35.19625600786368],[-82.40295410156249,35.22318504970181],
              [-82.4688720703125,35.16931803601131],[-82.6885986328125,35.1154153142536],
              [-82.781982421875,35.06147690849717],[-83.1060791015625,35.003003395276714],
              [-83.616943359375,34.99850370014629],[-84.05639648437499,34.985003130171066],
              [-84.22119140625,34.985003130171066],[-84.32281494140625,34.9895035675793]]],
            [[[-109.0283203125,36.98500309285596],[-109.0283203125,40.97989806962013],
              [-102.06298828125,40.97989806962013],[-102.06298828125,37.00255267215955],
              [-109.0283203125,36.98500309285596]]]]}

#Execute function
if __name__ == "__main__":
    print geojson_bbox(feature)
